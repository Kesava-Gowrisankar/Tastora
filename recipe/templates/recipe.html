{% extends 'base.html' %}

{% block content %}
<div class="w-[90vw] mx-auto mt-8">

    <h1 class="text-4xl font-bold text-center mb-6">
        Glow <span class="text-orange-400">Recipes</span>
    </h1>

    <form method="get"
          class="flex flex-wrap gap-4 bg-white p-4 rounded-lg shadow mb-8">

        <select name="category" class="border p-2 rounded-lg">
            <option value="" {% if not request.GET.category %}selected{% endif %}>All Types</option>
            <option value="0" {% if request.GET.category == "0" %}selected{% endif %}>Veg</option>
            <option value="1" {% if request.GET.category == "1" %}selected{% endif %}>Vegan</option>
            <option value="2" {% if request.GET.category == "2" %}selected{% endif %}>Non-Veg</option>
        </select>

        <select name="difficulty" class="border p-2 rounded-lg">
            <option value="" {% if not request.GET.difficulty %}selected{% endif %}>All Difficulty</option>
            <option value="0" {% if request.GET.difficulty == "0" %}selected{% endif %}>Easy</option>
            <option value="1" {% if request.GET.difficulty == "1" %}selected{% endif %}>Medium</option>
            <option value="2" {% if request.GET.difficulty == "2" %}selected{% endif %}>Hard</option>
        </select>

        <input type="text"
               name="cuisine"
               placeholder="Cuisine"
               value="{{ request.GET.cuisine|default:'' }}"
               class="border p-2 rounded-lg" />

        <input type="text"
               name="search"
               placeholder="Search"
               value="{{ request.GET.search|default:'' }}"
               class="border p-2 rounded-lg flex-1" />

        <button class="bg-orange-400 text-white px-4 py-2 rounded-lg hover:bg-orange-500 transition">
            Filter
        </button>

        <a href="{% url 'recipe:recipes' %}"
           class="bg-gray-300 text-black px-4 py-2 rounded-lg hover:bg-gray-400 transition">
            Clear
        </a>
    </form>

    <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
        {% for recipe in page_obj %}
            <a href="{{ recipe.get_absolute_url }}"
               class="bg-white p-4 rounded-xl shadow-md hover:shadow-orange-400/50 hover:shadow-2xl transition duration-300 group">

                <img src="{{ recipe.get_first_image_url }}"
                     class="w-full h-48 object-cover rounded-lg mb-3 transition-transform duration-300 group-hover:scale-105" />

                <h2 class="text-xl font-semibold group-hover:text-orange-400 transition">
                    {{ recipe.title|capfirst }}
                </h2>

                <p class="text-gray-500 text-sm mt-1">
                    {{ recipe.get_category_display }} â€¢ {{ recipe.get_difficulty_display }}
                </p>
            </a>
        {% endfor %}
    </div>

    <div class="flex justify-center mt-8 space-x-3 mb-8">
        {% if page_obj.has_previous %}
            <a href="?page={{ page_obj.previous_page_number }}{% for k, v in request.GET.items %}{% if k != 'page' %}&amp;{{ k }}={{ v }}{% endif %}{% endfor %}"
               class="px-4 py-2 border rounded-lg hover:bg-gray-100 transition">
                Prev
            </a>
        {% endif %}

        <span class="px-4 py-2 bg-orange-400 text-white rounded-lg">
            Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
        </span>

        {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}{% for k, v in request.GET.items %}{% if k != 'page' %}&amp;{{ k }}={{ v }}{% endif %}{% endfor %}"
               class="px-4 py-2 border rounded-lg hover:bg-gray-100 transition">
                Next
            </a>
        {% endif %}
    </div>

</div>
{% endblock %}
